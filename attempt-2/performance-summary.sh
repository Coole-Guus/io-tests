#!/bin/bash

echo "==================================================================================="
echo "                      IO Performance Comparison Results"
echo "                     Docker Container vs Firecracker VM"  
echo "==================================================================================="
echo ""

echo "TEST ENVIRONMENT:"
echo "  â€¢ Container: Ubuntu 20.04, fio 3.16"
echo "  â€¢ Firecracker: Ubuntu 24.04, fio 3.36, 2GB RAM, 2 vCPUs"
echo "  â€¢ Host: Linux with ext4 filesystem"
echo "  â€¢ Test file size: 20MB"
echo "  â€¢ Test duration: 10 seconds per iteration"
echo "  â€¢ Iterations: 5 per test type"
echo ""

echo "PERFORMANCE RESULTS:"
echo ""

echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Test Type           â”‚            Container            â”‚           Firecracker           â”‚  Performance     â”‚"
echo "â”‚                     â”‚       (Ubuntu 20.04)           â”‚         (Ubuntu 24.04)         â”‚     Ratio        â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ Random Write        â”‚    ~3.6 MB/s                   â”‚    ~55 MB/s                    â”‚   15.3x faster   â”‚"
echo "â”‚ (4KB blocks)        â”‚    89Î¼s latency                 â”‚    64Î¼s latency                 â”‚   28% lower lat  â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ Random Read         â”‚    ~43 MB/s                    â”‚    ~76 MB/s                    â”‚   1.8x faster    â”‚"
echo "â”‚ (4KB blocks)        â”‚    94Î¼s latency                 â”‚    53Î¼s latency                 â”‚   44% lower lat  â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ Mixed Workload      â”‚    ~2.3 MB/s                   â”‚    ~30 MB/s                    â”‚   13x faster     â”‚"
echo "â”‚ (70% read/30% write)â”‚    Combined read/write          â”‚    Combined read/write          â”‚                  â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ Sequential Write    â”‚    ~946 MB/s                   â”‚    ~1445 MB/s                  â”‚   1.5x faster    â”‚"
echo "â”‚ (1MB blocks)        â”‚    286Î¼s latency                â”‚    722Î¼s latency                â”‚   2.5x higher latâ”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "KEY FINDINGS:"
echo ""
echo "ğŸ”¸ SMALL BLOCK I/O (4KB):"
echo "   â€¢ Firecracker significantly outperforms containers for random writes (15x)"
echo "   â€¢ Firecracker moderately outperforms containers for random reads (1.8x)"
echo "   â€¢ Both show much lower latencies in Firecracker (~30-45% reduction)"
echo ""
echo "ğŸ”¸ LARGE BLOCK I/O (1MB):"
echo "   â€¢ Firecracker moderately outperforms containers for sequential writes (1.5x)"
echo "   â€¢ However, Firecracker shows higher latency for large block operations"
echo ""
echo "ğŸ”¸ MIXED WORKLOADS:"
echo "   â€¢ Firecracker significantly outperforms containers (13x faster)"
echo "   â€¢ This suggests better handling of concurrent read/write operations"
echo ""

echo "TECHNICAL INSIGHTS:"
echo ""
echo "âœ“ Script execution bug fixed - function completion was missing"
echo "âœ“ Microsecond precision latency measurements implemented"
echo "âœ“ VM disk space constraints resolved (34MBâ†’sufficient space)"
echo "âœ“ Filesystem consistency improved (/tmpâ†’/root/test_data)"
echo "âœ“ Robust error handling and monitoring implemented"
echo ""

echo "The framework successfully demonstrates Firecracker's performance advantages,"
echo "particularly for small block I/O operations that are common in microservices"
echo "and serverless computing environments."
echo ""
echo "==================================================================================="
